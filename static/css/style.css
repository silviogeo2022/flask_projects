/* Reset e tokens */
:root{
  --bg-start:#667eea;
  --bg-end:#764ba2;
  --card-bg:rgba(255,255,255,0.96);
  --glass:rgba(255,255,255,0.08);
  --text:#2b2d42;
  --muted:#6b7280;
  --primary:#667eea;
  --primary-dark:#545dd8;
  --success:#22c55e;
  --secondary:#6c757d;
  --shadow:0 8px 28px rgba(31,38,135,.25);
  --radius:16px;
}

*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}

body{
  font-family:Inter, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  background: linear-gradient(135deg, var(--bg-start) 0%, var(--bg-end) 100%);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
}

/* Shell */
.app-shell{ max-width:1400px; margin:0 auto; padding:0 16px }

.header{
  position:sticky; top:0; z-index:1000;
  display:flex; align-items:center; justify-content:space-between;
  padding:18px 16px;
  background: linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.10));
  backdrop-filter: blur(8px);
  border-bottom:1px solid rgba(255,255,255,.25);
}
.app-title{color:#fff;font-weight:600;display:flex;gap:10px;align-items:center}
.app-title i{opacity:.95}

.container{
  display:grid; grid-template-columns:300px 1fr;
  gap:16px; padding:16px;
  min-height:calc(100vh - 72px);
}

.sidebar{
  background:var(--card-bg);
  border-radius:var(--radius);
  padding:18px;
  box-shadow:var(--shadow);
  overflow:auto;
  max-height:calc(100vh - 120px);
}

.main-content{display:grid; grid-template-rows:auto 1fr auto; gap:16px}

/* Cards e estatísticas */
.stats-grid{ display:grid; gap:16px; grid-template-columns:repeat(4, minmax(180px, 1fr)) }
.stat-card{
  background:var(--card-bg); border-radius:var(--radius);
  padding:18px; text-align:center; box-shadow:var(--shadow);
  transition:transform .25s ease, box-shadow .25s ease;
}
.stat-card:hover{ transform:translateY(-4px); box-shadow:0 12px 30px rgba(31,38,135,.28) }
.stat-value{ font-size:2.1rem; font-weight:800; color:var(--primary); margin-bottom:6px }
.stat-label{ color:var(--muted); font-size:.95rem }

/* Map */
.map-card{ background:var(--card-bg); border-radius:var(--radius); overflow:hidden; box-shadow:var(--shadow) }
.map{ height:520px; width:100% }

/* Charts */
.charts-container{ display:grid; gap:16px; grid-template-columns:1fr 1fr }
.chart-card{ background:var(--card-bg); border-radius:var(--radius); padding:16px; box-shadow:var(--shadow) }
.chart-wrapper{ position:relative; height:320px }

/* Filtros e formulários */
.section-title{ color:var(--primary); font-size:1.05rem; display:flex; gap:8px; align-items:center; margin-bottom:12px }
.filter-section{ margin-bottom:20px; padding-bottom:16px; border-bottom:1px solid #eef2f7 }
.form-group{ margin-bottom:14px }
.form-group label{ display:block; margin-bottom:6px; font-weight:600; color:#374151 }
.form-control{
  width:100%; padding:10px 12px; border:2px solid #e5e7eb; border-radius:10px;
  background:#fff; transition:border-color .2s, box-shadow .2s; font-size:.95rem;
}
.form-control:focus{ outline:none; border-color:var(--primary); box-shadow:0 0 0 3px rgba(102,126,234,.18) }

/* Autocomplete */
.autocomplete{
  display:none; background:#fff; border:1px solid #e5e7eb; border-radius:10px;
  margin-top:6px; max-height:240px; overflow:auto; box-shadow:0 10px 24px rgba(0,0,0,.08);
}
.autocomplete > div{
  padding:10px 12px; cursor:pointer; border-bottom:1px solid #f1f5f9;
}
.autocomplete > div:hover{ background:#f8fafc }

/* Botões */
.btn{ display:inline-flex; align-items:center; gap:8px;
  padding:10px 14px; border:none; border-radius:10px; font-weight:600;
  cursor:pointer; transition:transform .15s ease, box-shadow .15s ease, background .15s ease;
  text-decoration:none; user-select:none;
}
.btn-row{ display:flex; flex-wrap:wrap; gap:8px }
.btn-primary{ background:linear-gradient(45deg, var(--primary), var(--bg-end)); color:#fff }
.btn-primary:hover{ transform:translateY(-2px); box-shadow:0 8px 18px rgba(102,126,234,.35) }
.btn-secondary{ background:#6b7280; color:#fff }
.btn-secondary:hover{ transform:translateY(-2px); box-shadow:0 8px 18px rgba(107,114,128,.25) }
.btn-success{ background:var(--success); color:#fff }
.btn-success:hover{ transform:translateY(-2px); box-shadow:0 8px 18px rgba(34,197,94,.28) }

/* Alerts */
.alert{ display:none; padding:12px 14px; border-radius:10px; margin-bottom:12px; font-weight:600 }
.alert-error{ background:#fde8e8; color:#b91c1c; border:1px solid #fecaca }
.alert-success{ background:#e7f6ec; color:#166534; border:1px solid #bbf7d0 }

/* Legend Leaflet */
.legend{
  background:var(--card-bg); padding:10px 12px; border-radius:10px; line-height:18px; color:#374151;
  box-shadow:0 6px 18px rgba(0,0,0,.12); border:1px solid #eef2f7;
}
.legend i{ width:18px; height:18px; float:left; margin-right:8px; opacity:.9; border-radius:3px }

/* Toggle sidebar (mobile) */
.toggle-btn{
  display:none; position:absolute; right:16px; top:14px; z-index:1001;
  background:rgba(255,255,255,.9); border:none; border-radius:50%; width:44px; height:44px; cursor:pointer;
  box-shadow:var(--shadow);
}

/* Loading */
.loading{
  display:none; position:fixed; inset:0; background:rgba(255,255,255,.55);
  backdrop-filter: blur(2px);
  align-items:center; justify-content:center; flex-direction:column;
  gap:12px; z-index:1100;
}
.loading .spinner{
  border:3px solid #eef2f7; border-top:3px solid var(--primary);
  border-radius:50%; width:42px; height:42px; animation:spin 1s linear infinite;
}
@keyframes spin{ to{ transform:rotate(360deg) } }

/* Responsividade */
@media (max-width: 1024px){
  .stats-grid{ grid-template-columns:repeat(2, 1fr) }
  .charts-container{ grid-template-columns:1fr }
}

@media (max-width: 768px){
  .container{ grid-template-columns:1fr; min-height:auto }
  .sidebar{
    position:fixed; top:72px; left:-100%; height:calc(100vh - 72px); width:300px;
    transition:left .25s ease; z-index:1000;
  }
  .sidebar.active{ left:0 }
  .toggle-btn{ display:block }
  .map{ height:420px }
}